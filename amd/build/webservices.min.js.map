{"version":3,"file":"webservices.min.js","sources":["../src/webservices.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\r\n//\r\n// Moodle is free software: you can redistribute it and/or modify\r\n// it under the terms of the GNU General Public License as published by\r\n// the Free Software Foundation, either version 3 of the License, or\r\n// (at your option) any later version.\r\n//\r\n// Moodle is distributed in the hope that it will be useful,\r\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n// GNU General Public License for more details.\r\n//\r\n// You should have received a copy of the GNU General Public License\r\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\r\n\r\n/**\r\n * Webservices actions.\r\n *\r\n * @module     local_wsmanager/webservices\r\n * @copyright  2023 Lilia Smirnova <lilia.pro@protonmail.com>\r\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\r\n */\r\ndefine([\r\n    'jquery',\r\n    'core/ajax',\r\n    'core/modal_factory',\r\n    'core/modal_events',\r\n    'local_wsmanager/base'\r\n], function (\r\n    jQuery,\r\n    ajax,\r\n    ModalFactory,\r\n    ModalEvents,\r\n    LocalWSManagerBase\r\n) {\r\n    return {\r\n        local_wsmanager_webservice_tokens_table_output: function (webserviceid) {\r\n            return ajax.call([{\r\n                methodname: 'local_wsmanager_webservice_tokens_table_output',\r\n                args: {\r\n                    webserviceid: webserviceid\r\n                }\r\n            }])[0]\r\n                .then(function (res) {\r\n                    jQuery('#local_wsmanager_webservice_tokens_table_' + webserviceid).html(res);\r\n                });\r\n        },\r\n        local_wsmanager_functions_table_output: function (webserviceid) {\r\n            return ajax.call([{\r\n                methodname: 'local_wsmanager_webservice_functions_table_output',\r\n                args: {\r\n                    webserviceid: webserviceid\r\n                }\r\n            }])[0]\r\n                .then(function (res) {\r\n                    jQuery('#local_wsmanager_webservice_functions_table_' + id).html(res);\r\n                });\r\n        },\r\n        init: function (sep1, sep2, sep3, sep4) {\r\n            var ctx = this,\r\n                anchor = window.location.hash.substring(1);\r\n            if (anchor) {\r\n                switch (anchor) {\r\n                    case 'create_webservice_form':\r\n                        jQuery('#local_wsmanager_create_webservice_form').show();\r\n                        jQuery('#local_wsmanager_create_webservice_form_show').addClass('opened');\r\n                        break;\r\n                }\r\n            }\r\n            jQuery('body')\r\n                .on('click', '.local_wsmanager_tab_link', function (event) {\r\n                    event.preventDefault();\r\n                    var $this = jQuery(this),\r\n                        webserviceid = $this.data('webserviceid');\r\n                    jQuery('.local_wsmanager_tab_link').removeClass('active');\r\n                    $this.addClass('active');\r\n                    jQuery('.local_wsmanager_webservice_data_output').hide();\r\n                    jQuery('#local_wsmanager_webservice_data_output_' + webserviceid).show();\r\n                    return false;\r\n                })\r\n                .on('click', '#local_wsmanager_create_webservice_form_show', function (event) {\r\n                    event.preventDefault();\r\n                    var $this = jQuery(this);\r\n                    if (!$this.hasClass('opened')) {\r\n                        jQuery('#local_wsmanager_create_webservice_form').show();\r\n                        $this.addClass('opened');\r\n                    } else {\r\n                        jQuery('#local_wsmanager_create_webservice_form').hide();\r\n                        $this.removeClass('opened');\r\n                    }\r\n                    return false;\r\n                })\r\n                .on('submit', '#local_wsmanager_create_webservice_form form', function (event) {\r\n                    event.preventDefault();\r\n                    var $this = jQuery(this),\r\n                        data = {},\r\n                        formData = $this.serializeArray();\r\n                    if (formData) {\r\n                        jQuery.each(formData, function (i, item) {\r\n                            if (item.name) {\r\n                                switch (item.name) {\r\n                                    case 'sesskey':\r\n                                        data.sesskey = item.value;\r\n                                        break;\r\n                                    case '_qf__local_wsmanager_webservice_form':\r\n                                        data._qf__local_wsmanager_webservice_form = parseInt(item.value);\r\n                                        break;\r\n                                    case 'name':\r\n                                        data.name = item.value;\r\n                                        break;\r\n                                    case 'shortname':\r\n                                        data.shortname = item.value;\r\n                                        break;\r\n                                    case 'enabled':\r\n                                        data.enabled = parseInt(item.value);\r\n                                        break;\r\n                                    case 'restrictedusers':\r\n                                        data.restrictedusers = parseInt(item.value);\r\n                                        break;\r\n                                    case 'downloadfiles':\r\n                                        data.downloadfiles = parseInt(item.value);\r\n                                        break;\r\n                                    case 'uploadfiles':\r\n                                        data.uploadfiles = parseInt(item.value);\r\n                                        break;\r\n                                    case 'requiredcapability':\r\n                                        data.requiredcapability = item.value;\r\n                                        break;\r\n                                }\r\n                            }\r\n                        });\r\n                        jQuery.post(\r\n                            M.cfg.wwwroot + '/local/wsmanager/webservices.php',\r\n                            data,\r\n                            function (response) {\r\n                                if (response.success) {\r\n                                    ajax.call([{\r\n                                        methodname: 'local_wsmanager_webservice_create',\r\n                                        args: {\r\n                                            name: data.name,\r\n                                            shortname: data.shortname,\r\n                                            enabled: data.enabled,\r\n                                            restrictedusers: data.restrictedusers,\r\n                                            downloadfiles: data.downloadfiles,\r\n                                            uploadfiles: data.uploadfiles,\r\n                                            requiredcapability: data.requiredcapability\r\n                                        }\r\n                                    }])[0]\r\n                                        .then(function (res) {\r\n                                            if (res.errors.length === 0 && res.errors.webservice) {\r\n                                                window.location.replace(jQuery('#local_wsmanager_url').val());\r\n                                            }\r\n                                        });\r\n                                }\r\n                            },\r\n                            'json'\r\n                        );\r\n                    }\r\n                    return false;\r\n                })\r\n                .on('click', '#local_wsmanager_create_webservice_form [name=\"cancel\"]', function (event) {\r\n                    event.preventDefault();\r\n                    jQuery('#local_wsmanager_create_webservice_form').hide();\r\n                    return false;\r\n                })\r\n                .on('click', '.local_wsmanager_webservice_token_create_form_button', function (event) {\r\n                    event.preventDefault();\r\n                    var $this = jQuery(this),\r\n                        webserviceid = $this.data('webserviceid');\r\n                    jQuery('#local_wsmanager_webservice_token_create_form_wrapper_' + webserviceid).show();\r\n                    $this.hide();\r\n                    return false;\r\n                })\r\n                .on('submit', '.local_wsmanager_webservice_token_create_form', function (event) {\r\n                    event.preventDefault();\r\n                    var $this = jQuery(this),\r\n                        data = {\r\n                            valid_until: {}\r\n                        },\r\n                        formData = $this.serializeArray();\r\n                    if (formData) {\r\n                        jQuery.each(formData, function (i, item) {\r\n                            if (item.name) {\r\n                                switch (item.name) {\r\n                                    case 'webserviceid':\r\n                                        data.webserviceid = parseInt(item.value);\r\n                                        break;\r\n                                    case 'sesskey':\r\n                                        data.sesskey = item.value;\r\n                                        break;\r\n                                    case '_qf__local_wsmanager_token_form':\r\n                                        data._qf__local_wsmanager_token_form = parseInt(item.value);\r\n                                        break;\r\n                                    case 'user':\r\n                                        data.user = parseInt(item.value);\r\n                                        break;\r\n                                    case 'iprestriction':\r\n                                        data.iprestriction = jQuery.trim(item.value);\r\n                                        break;\r\n                                    case 'validuntil[enabled]':\r\n                                        data.validUntilEnabled = true;\r\n                                        break;\r\n                                    case 'validuntil[day]':\r\n                                        data.valid_until.day = parseInt(item.value);\r\n                                        break;\r\n                                    case 'validuntil[month]':\r\n                                        data.valid_until.month = parseInt(item.value);\r\n                                        break;\r\n                                    case 'validuntil[year]':\r\n                                        data.valid_until.year = parseInt(item.value);\r\n                                        break;\r\n                                }\r\n                            }\r\n                        });\r\n                        if (!data.validUntilEnabled) {\r\n                            data.valid_until = {};\r\n                        }\r\n                        jQuery.post(\r\n                            M.cfg.wwwroot + '/local/wsmanager/webservices.php',\r\n                            data,\r\n                            function (response) {\r\n                                if (response.success) {\r\n                                    ajax.call([{\r\n                                        methodname: 'local_wsmanager_webservice_token_create',\r\n                                        args: {\r\n                                            webserviceid: data.webserviceid,\r\n                                            userid: data.user,\r\n                                            iprestriction: data.iprestriction,\r\n                                            valid_until: data.valid_until\r\n                                        }\r\n                                    }])[0]\r\n                                        .then(function (res) {\r\n                                            if (res.id) {\r\n                                                ctx.local_wsmanager_webservice_tokens_table_output(data.webserviceid);\r\n                                            }\r\n                                        });\r\n                                }\r\n                            },\r\n                            'json'\r\n                        );\r\n                    }\r\n                    return false;\r\n                })\r\n                .on('click', '.local_wsmanager_webservice_token_create_form_wrapper [name=\"cancel\"]', function (event) {\r\n                    event.preventDefault();\r\n                    var $this = jQuery(this),\r\n                        parent = $this.closest('.local_wsmanager_webservice_token_create_form_wrapper'),\r\n                        webserviceid = 0;\r\n                    if (parent) {\r\n                        webserviceid = parent.data('webserviceid');\r\n                        jQuery('#local_wsmanager_webservice_token_create_form_button_' + webserviceid).show();\r\n                        jQuery('#local_wsmanager_webservice_token_create_form_wrapper_' + webserviceid).hide();\r\n                    }\r\n                    return false;\r\n                })\r\n                .on('click', '.local_wsmanager_webservice_token_delete', function (event) {\r\n                    event.preventDefault();\r\n                    var $this = jQuery(this),\r\n                        webserviceid = parseInt($this.data('webserviceid')),\r\n                        tokenid = parseInt($this.data('tokenid')),\r\n                        token = $this.data('token');\r\n                    if (tokenid) {\r\n                        ModalFactory.create({\r\n                            type: ModalFactory.types.SAVE_CANCEL,\r\n                            title: M.str.webservice.deletetoken,\r\n                            body: M.str.webservice.deletetoken + ' <strong>' + token + '</strong><br />' +\r\n                                M.str.moodle.areyousure\r\n                        })\r\n                            .then(function (modal) {\r\n                                modal.setButtonText('save', M.str.moodle.delete);\r\n                                modal.getRoot().on(ModalEvents.save, function (e) {\r\n                                    e.preventDefault();\r\n                                    ajax.call([{\r\n                                        methodname: 'local_wsmanager_webservice_token_delete',\r\n                                        args: {\r\n                                            tokenid: tokenid\r\n                                        }\r\n                                    }])[0]\r\n                                        .then(function (response) {\r\n                                            ctx.local_wsmanager_webservice_tokens_table_output(webserviceid);\r\n                                        });\r\n                                    modal.hide();\r\n                                });\r\n                                modal.getRoot().on(ModalEvents.cancel, function () {\r\n                                    modal.hide();\r\n                                });\r\n                                modal.show();\r\n                            });\r\n                    }\r\n\r\n                    return false;\r\n                })\r\n                .on('click', '.local_wsmanager_webservice_functions_add_form_button', function (event) {\r\n                    event.preventDefault();\r\n                    var $this = jQuery(this),\r\n                        webserviceid = $this.data('webserviceid');\r\n                    jQuery('#local_wsmanager_webservice_functions_add_form_wrapper_' + webserviceid).show();\r\n                    $this.hide();\r\n                    return false;\r\n                })\r\n                .on('submit', '.local_wsmanager_webservice_functions_add_form', function (event) {\r\n                    event.preventDefault();\r\n                    var $this = jQuery(this),\r\n                        fids = [],\r\n                        webserviceid = $this.data('webserviceid'),\r\n                        formData = $this.serializeArray();\r\n                    if (formData) {\r\n                        jQuery.each(formData, function (i, item) {\r\n                            if (item.name) {\r\n                                switch (item.name) {\r\n                                    case 'fids[]':\r\n                                        fids.push(parseInt(item.value));\r\n                                        break;\r\n                                }\r\n                            }\r\n                        });\r\n                        if (fids.length) {\r\n                            jQuery.each(fids, function (i, fid) {\r\n                                ajax.call([{\r\n                                    methodname: 'local_wsmanager_webservice_function_add',\r\n                                    args: {\r\n                                        functionid: fid,\r\n                                        webserviceid: webserviceid\r\n                                    }\r\n                                }])[0]\r\n                                    .then(function (response) {\r\n                                        ctx.local_wsmanager_functions_table_output(webserviceid);\r\n                                    });\r\n                            });\r\n                        }\r\n                    }\r\n                    return false;\r\n                })\r\n                .on('click', '.local_wsmanager_webservice_functions_add_form_wrapper [name=\"cancel\"]', function (event) {\r\n                    event.preventDefault();\r\n                    var $this = jQuery(this),\r\n                        parent = $this.closest('.local_wsmanager_webservice_functions_add_form_wrapper'),\r\n                        webserviceid = 0;\r\n                    if (parent) {\r\n                        webserviceid = parent.data('webserviceid');\r\n                        jQuery('#local_wsmanager_webservice_functions_add_form_button_' + webserviceid).show();\r\n                        jQuery('#local_wsmanager_webservice_functions_add_form_wrapper_' + webserviceid).hide();\r\n                    }\r\n                    return false;\r\n                })\r\n                .on('click', '.local_wsmanager_webservice_function_delete', function (event) {\r\n                    event.preventDefault();\r\n                    var $this = jQuery(this),\r\n                        webserviceid = parseInt($this.data('webserviceid')),\r\n                        functionid = parseInt($this.data('functionid')),\r\n                        functionname = $this.data('functionname');\r\n                    if (webserviceid && functionid && functionname) {\r\n                        ModalFactory.create({\r\n                            type: ModalFactory.types.SAVE_CANCEL,\r\n                            title: M.str.webservice.removefunction,\r\n                            body: M.str.webservice.removefunction + ' <strong>' + functionname + '</strong><br />' +\r\n                                M.str.moodle.areyousure\r\n                        })\r\n                            .then(function (modal) {\r\n                                modal.setButtonText('save', M.str.moodle.remove);\r\n                                modal.getRoot().on(ModalEvents.save, function (e) {\r\n                                    e.preventDefault();\r\n                                    ajax.call([{\r\n                                        methodname: 'local_wsmanager_webservice_function_delete',\r\n                                        args: {\r\n                                            functionid: functionid,\r\n                                            webserviceid: webserviceid\r\n                                        }\r\n                                    }])[0]\r\n                                        .then(function (response) {\r\n                                            ctx.local_wsmanager_functions_table_output(webserviceid);\r\n                                        });\r\n                                    modal.hide();\r\n                                });\r\n                                modal.getRoot().on(ModalEvents.cancel, function () {\r\n                                    modal.hide();\r\n                                });\r\n                                modal.show();\r\n                            });\r\n                    }\r\n                    return false;\r\n                })\r\n                .on('click', '.local_wsmanager_webservice_delete', function (event) {\r\n                    event.preventDefault();\r\n                    var $this = jQuery(this),\r\n                        webserviceid = parseInt($this.data('webserviceid')),\r\n                        name = $this.data('name');\r\n                    if (webserviceid) {\r\n                        ModalFactory.create({\r\n                            type: ModalFactory.types.SAVE_CANCEL,\r\n                            title: M.str.webservice.deleteaservice,\r\n                            body: M.str.webservice.deleteaservice + ' ' + name + '<br />' + M.str.moodle.areyousure\r\n                        })\r\n                            .then(function (modal) {\r\n                                modal.setButtonText('save', M.str.moodle.delete);\r\n                                modal.getRoot().on(ModalEvents.save, function (e) {\r\n                                    e.preventDefault();\r\n                                    ajax.call([{\r\n                                        methodname: 'local_wsmanager_webservice_delete',\r\n                                        args: {\r\n                                            webserviceid: webserviceid\r\n                                        }\r\n                                    }])[0]\r\n                                        .then(function (response) {\r\n                                            window.location.replace(jQuery('#local_wsmanager_url').val());\r\n                                        });\r\n                                    modal.hide();\r\n                                });\r\n                                modal.getRoot().on(ModalEvents.cancel, function () {\r\n                                    modal.hide();\r\n                                });\r\n                                modal.show();\r\n                            });\r\n                    }\r\n\r\n                    return false;\r\n                })\r\n                .on('click', '.local_wsmanager_webservice_user_delete', function (event) {\r\n                    event.preventDefault();\r\n                    var $this = jQuery(this),\r\n                        webserviceid = parseInt($this.data('webserviceid')),\r\n                        userid = $this.data('userid');\r\n\r\n                    if (webserviceid && userid) {\r\n                        ModalFactory.create({\r\n                            type: ModalFactory.types.SAVE_CANCEL,\r\n                            title: M.str.admin.deleteuser,\r\n                            body: M.str.moodle.areyousure\r\n                        })\r\n                            .then(function (modal) {\r\n                                modal.setButtonText('save', M.str.moodle.delete);\r\n                                modal.getRoot().on(ModalEvents.save, function (e) {\r\n                                    e.preventDefault();\r\n                                    ajax.call([{\r\n                                        methodname: 'local_wsmanager_webservice_user_delete',\r\n                                        args: {\r\n                                            webserviceid: webserviceid,\r\n                                            userid: userid\r\n                                        }\r\n                                    }])[0]\r\n                                        .then(function (response) {\r\n                                            var cnt = jQuery('.local_wsmanager_webservice_user_row_' +\r\n                                                webserviceid).length;\r\n                                            if (response) {\r\n                                                jQuery('#local_wsmanager_webservice_user_row_' +\r\n                                                    webserviceid + '_' + userid).remove();\r\n                                                if (cnt === 1) {\r\n                                                    jQuery('#local_wsmanager_webservice_users_table_' + webserviceid)\r\n                                                        .remove();\r\n                                                }\r\n                                            }\r\n                                        });\r\n                                    modal.hide();\r\n                                });\r\n                                modal.getRoot().on(ModalEvents.cancel, function () {\r\n                                    modal.hide();\r\n                                });\r\n                                modal.show();\r\n                            });\r\n                    }\r\n                    return false;\r\n                });\r\n        }\r\n    };\r\n});"],"names":["define","jQuery","ajax","ModalFactory","ModalEvents","LocalWSManagerBase","local_wsmanager_webservice_tokens_table_output","webserviceid","call","methodname","args","then","res","html","local_wsmanager_functions_table_output","id","init","sep1","sep2","sep3","sep4","ctx","this","anchor","window","location","hash","substring","show","addClass","on","event","preventDefault","$this","data","removeClass","hide","hasClass","formData","serializeArray","each","i","item","name","sesskey","value","_qf__local_wsmanager_webservice_form","parseInt","shortname","enabled","restrictedusers","downloadfiles","uploadfiles","requiredcapability","post","M","cfg","wwwroot","response","success","errors","length","webservice","replace","val","valid_until","_qf__local_wsmanager_token_form","user","iprestriction","trim","validUntilEnabled","day","month","year","userid","parent","closest","tokenid","token","create","type","types","SAVE_CANCEL","title","str","deletetoken","body","moodle","areyousure","modal","setButtonText","delete","getRoot","save","e","cancel","fids","push","fid","functionid","functionname","removefunction","remove","deleteaservice","admin","deleteuser","cnt"],"mappings":"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"}